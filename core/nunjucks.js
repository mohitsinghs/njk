/* eslint-disable */
// prettier-ignore
/*
Copyright (c) 2012-2015, James Long
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

    Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
let f$=Object.hasOwnProperty,h$={},j$,k$=a$=>{let b$=h$[a$];return b$||(b$=h$[a$]={exports:{}},j$[a$](b$.exports,b$)),b$.exports},l$=a$=>{if(a$&&a$.__esModule)return a$;let b$={};for(let c$ in a$)f$.call(a$,c$)&&(b$[c$]=a$[c$]);return b$.default=a$,b$},p$=a$=>l$(k$(a$));j$={11(f,v){"use strict";var n=Array.prototype,j=Object.prototype,w={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},x=/[&"'<>]/g,f=v.exports={};function o(a,b){return j.hasOwnProperty.call(a,b)}f.hasOwnProp=o;function y(a){return w[a]}function z(a,b,d){d.Update||(d=new f.TemplateError(d)),d.Update(a);if(!b){const c=d;d=new Error(c.message),d.name=c.name}return d}f._prettifyError=z;function k(a,b,d){var c,e;a instanceof Error&&(e=a,a=`${e.name}: ${e.message}`),Object.setPrototypeOf?(c=new Error(a),Object.setPrototypeOf(c,k.prototype)):(c=this,Object.defineProperty(c,"message",{enumerable:!1,writable:!0,value:a})),Object.defineProperty(c,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(c,this.constructor);let g;if(e){const h=Object.getOwnPropertyDescriptor(e,"stack");g=h&&(h.get||(()=>h.value)),g||(g=()=>e.stack)}else{const h=new Error(a).stack;g=()=>h}return Object.defineProperty(c,"stack",{get:()=>g.call(c)}),Object.defineProperty(c,"cause",{value:e}),c.lineno=b,c.colno=d,c.firstUpdate=!0,c.Update=function h(i){let m="("+(i||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?m+=` [Line ${this.lineno}, Column ${this.colno}]`:this.lineno&&(m+=` [Line ${this.lineno}]`)),m+=`
 `,this.firstUpdate&&(m+=" "),this.message=m+(this.message||""),this.firstUpdate=!1,this},c}Object.setPrototypeOf?Object.setPrototypeOf(k.prototype,Error.prototype):k.prototype=Object.create(Error.prototype,{constructor:{value:k}}),f.TemplateError=k;function A(a){return a.replace(x,y)}f.escape=A;function p(a){return j.toString.call(a)==="[object Function]"}f.isFunction=p;function q(a){return j.toString.call(a)==="[object Array]"}f.isArray=q;function r(a){return j.toString.call(a)==="[object String]"}f.isString=r;function s(a){return j.toString.call(a)==="[object Object]"}f.isObject=s;function B(a){return a?typeof a==="string"?a.split("."):[a]:[]}function C(a){const b=B(a);return function d(c){let e=c;for(let g=0;g<b.length;g++){const h=b[g];if(o(e,h))e=e[h];else return}return e}}function D(a,b,d){const c={},e=p(b)?b:C(b);for(let g=0;g<a.length;g++){const h=a[g],i=e(h,g);if(i===void 0&&d===!0)throw new TypeError(`groupby: attribute "${b}" resolved to undefined`);(c[i]||(c[i]=[])).push(h)}return c}f.groupBy=D;function t(a){return Array.prototype.slice.call(a)}f.toArray=t;function E(a){const b=[];if(!a)return b;const d=a.length,c=t(arguments).slice(1);let e=-1;for(;++e<d;)u(c,a[e])===-1&&b.push(a[e]);return b}f.without=E;function F(a,b){var d="";for(let c=0;c<b;c++)d+=a;return d}f.repeat=F;function G(a,b,d){if(a==null)return;if(n.forEach&&a.forEach===n.forEach)a.forEach(b,d);else if(a.length===+a.length)for(let c=0,e=a.length;c<e;c++)b.call(d,a[c],c,a)}f.each=G;function H(a,b){var d=[];if(a==null)return d;if(n.map&&a.map===n.map)return a.map(b);for(let c=0;c<a.length;c++)d[d.length]=b(a[c],c);return a.length===+a.length&&(d.length=a.length),d}f.map=H;function I(a,b,d){let c=-1;function e(){c++,c<a.length?b(a[c],c,e,d):d()}e()}f.asyncIter=I;function J(a,b,d){const c=l(a||{}),e=c.length;let g=-1;function h(){g++;const i=c[g];g<e?b(i,a[i],g,e,h):d()}h()}f.asyncFor=J;function u(a,b,d){return Array.prototype.indexOf.call(a||[],b,d)}f.indexOf=u;function l(a){const b=[];for(let d in a)o(a,d)&&b.push(d);return b}f.keys=l;function K(a){return l(a).map(b=>[b,a[b]])}f._entries=K;function L(a){return l(a).map(b=>a[b])}f._values=L;function M(a,b){return a=a||{},l(b).forEach(d=>{a[d]=b[d]}),a}f._assign=f.extend=M;function N(a,b){if(q(b)||r(b))return b.indexOf(a)!==-1;if(s(b))return a in b;throw new Error('Cannot use "in" operator to search for "'+a+'" in unexpected types.')}f.inOperator=N},2(o,k){"use strict";var d,l=typeof setImmediate==="function";k.exports=g;function g(c){a.length||(i(),f=!0),a[a.length]=c}var a=[],f=!1,b=0,m=1024;function h(){for(;b<a.length;){var c=b;b=b+1,a[c].call();if(b>m){for(var e=0,n=a.length-b;e<n;e++)a[e]=a[e+b];a.length-=b,b=0}}a.length=0,b=0,f=!1}g.requestFlush=i;function i(){var c=process.domain;c&&(d||(d=require("domain")),d.active=process.domain=null),f&&l?setImmediate(h):process.nextTick(h),c&&(d.active=process.domain=c)}},1(i,g){"use strict";var d=k$(2),c=[];g.exports=h;function h(b){var a;c.length?a=c.pop():a=new e(),a.task=b,a.domain=process.domain,d(a)}function e(){this.task=null,this.domain=null}e.prototype.call=function(){this.domain&&this.domain.enter();var b=!0;try{this.task.call(),b=!1,this.domain&&this.domain.exit()}finally{b&&d.requestFlush(),this.task=null,this.domain=null,c.push(this)}}},0(k,e){(function(l){"use strict";var m=function(){var a=Array.prototype.slice.call(arguments);typeof a[0]==="function"&&a[0].apply(null,a.splice(1))},n=function(a){typeof setImmediate==="function"?setImmediate(a):typeof process!=="undefined"&&process.nextTick?process.nextTick(a):setTimeout(a,0)},o=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},p=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},f=function(a,b,c){var d=c?n:m;b=b||function(){};if(!p(a)){var q=new Error("First argument to waterfall must be an array of functions");return b(q)}if(!a.length)return b();var h=function(i){return function(r){if(r)b.apply(null,arguments),b=function(){};else{var g=Array.prototype.slice.call(arguments,1),j=i.next();j?g.push(h(j)):g.push(b),d(function(){i.apply(null,g)})}}};h(o(a))()};typeof define!=="undefined"&&define.amd?define([],function(){return f}):typeof e!=="undefined"&&e.exports?e.exports=f:l.waterfall=f})(k)},10(W,L){"use strict";const j=k$(11);let k=` 
	\rÂ `,l="()[]{}%*-+~/#,:|.<>=!",M="0123456789",N="{%",O="%}",P="{{",Q="}}",R="{#",S="#}",m="string",n="whitespace",o="data",p="block-start",q="block-end",r="variable-start",s="variable-end",t="comment",u="left-paren",v="right-paren",w="left-bracket",x="right-bracket",y="left-curly",z="right-curly",A="operator",B="comma",C="colon",D="tilde",E="pipe",F="int",G="float",H="boolean",i="none",I="symbol",T="special",J="regex";function f(b,c,a,d){return{type:b,value:c,lineno:a,colno:d}}class U{constructor(b,c){this.str=b,this.index=0,this.len=b.length,this.lineno=0,this.colno=0,this.in_code=!1,c=c||{};let a=c.tags||{};this.tags={BLOCK_START:a.blockStart||N,BLOCK_END:a.blockEnd||O,VARIABLE_START:a.variableStart||P,VARIABLE_END:a.variableEnd||Q,COMMENT_START:a.commentStart||R,COMMENT_END:a.commentEnd||S},this.trimBlocks=!!c.trimBlocks,this.lstripBlocks=!!c.lstripBlocks}nextToken(){let b=this.lineno,c=this.colno,a;if(this.in_code){let d=this.current();if(this.isFinished())return null;{if(d==='"'||d==="'")return f(m,this._parseString(d),b,c);{if(a=this._extract(k))return f(n,a,b,c);{if((a=this._extractString(this.tags.BLOCK_END))||(a=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,this.trimBlocks&&(d=this.current(),d===`
`?this.forward():d==="\r"&&(this.forward(),d=this.current(),d===`
`?this.forward():this.back())),f(q,a,b,c);{if((a=this._extractString(this.tags.VARIABLE_END))||(a=this._extractString("-"+this.tags.VARIABLE_END)))return this.in_code=!1,f(s,a,b,c);if(d==="r"&&this.str.charAt(this.index+1)==="/"){this.forwardN(2);let g="";for(;!this.isFinished();)if(this.current()==="/"&&this.previous()!=="\\"){this.forward();break}else g+=this.current(),this.forward();let h=["g","i","m","y"],e="";for(;!this.isFinished();){let V=h.indexOf(this.current())!==-1;if(V)e+=this.current(),this.forward();else break}return f(J,{body:g,flags:e},b,c)}else if(l.indexOf(d)!==-1){this.forward();let g=["==","===","!=","!==","<=",">=","//","**"],h=d+this.current(),e;j.indexOf(g,h)!==-1&&(this.forward(),d=h,j.indexOf(g,h+this.current())!==-1&&(d=h+this.current(),this.forward()));switch(d){case"(":e=u;break;case")":e=v;break;case"[":e=w;break;case"]":e=x;break;case"{":e=y;break;case"}":e=z;break;case",":e=B;break;case":":e=C;break;case"~":e=D;break;case"|":e=E;break;default:e=A}return f(e,d,b,c)}else{a=this._extractUntil(k+l);if(a.match(/^[-+]?[0-9]+$/))if(this.current()==="."){this.forward();let g=this._extract(M);return f(G,a+"."+g,b,c)}else return f(F,a,b,c);else{if(a.match(/^(true|false)$/))return f(H,a,b,c);{if(a==="none")return f(i,a,b,c);{if(a==="null")return f(i,a,b,c);{if(a)return f(I,a,b,c);throw new Error("Unexpected value while parsing: "+a)}}}}}}}}}}else{let d=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.isFinished())return null;{if((a=this._extractString(this.tags.BLOCK_START+"-"))||(a=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,f(p,a,b,c);{if((a=this._extractString(this.tags.VARIABLE_START+"-"))||(a=this._extractString(this.tags.VARIABLE_START)))return this.in_code=!0,f(r,a,b,c);{a="";let g,h=!1;for(this._matches(this.tags.COMMENT_START)&&(h=!0,a=this._extractString(this.tags.COMMENT_START));(g=this._extractUntil(d))!==null;){a+=g;if((this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!h){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=a.length){let e=a.slice(-this.colno);if(/^\s+$/.test(e)){a=a.slice(0,-this.colno);if(!a.length)return this.nextToken()}}break}else if(this._matches(this.tags.COMMENT_END)){if(!h)throw new Error("unexpected end of comment");a+=this._extractString(this.tags.COMMENT_END);break}else a+=this.current(),this.forward()}if(g===null&&h)throw new Error("expected end of comment, got end of file");return f(h?t:o,a,b,c)}}}}}_parseString(b){this.forward();let c="";for(;!this.isFinished()&&this.current()!==b;){let a=this.current();if(a==="\\"){this.forward();switch(this.current()){case"n":c+=`
`;break;case"t":c+="	";break;case"r":c+="\r";break;default:c+=this.current()}this.forward()}else c+=a,this.forward()}return this.forward(),c}_matches(b){if(this.index+b.length>this.len)return null;let c=this.str.slice(this.index,this.index+b.length);return c===b}_extractString(b){return this._matches(b)?(this.forwardN(b.length),b):null}_extractUntil(b){return this._extractMatching(!0,b||"")}_extract(b){return this._extractMatching(!1,b)}_extractMatching(b,c){if(this.isFinished())return null;let a=c.indexOf(this.current());if(b&&a===-1||!b&&a!==-1){let d=this.current();this.forward();let g=c.indexOf(this.current());for(;(b&&g===-1||!b&&g!==-1)&&!this.isFinished();)d+=this.current(),this.forward(),g=c.indexOf(this.current());return d}return""}_extractRegex(b){let c=this.currentStr().match(b);return c?(this.forwardN(c[0].length),c):null}isFinished(){return this.index>=this.len}forwardN(b){for(let c=0;c<b;c++)this.forward()}forward(){this.index++,this.previous()===`
`?(this.lineno++,this.colno=0):this.colno++}backN(b){for(let c=0;c<b;c++)this.back()}back(){this.index--;if(this.current()===`
`){this.lineno--;let b=this.src.lastIndexOf(`
`,this.index-1);b===-1?this.colno=this.index:this.colno=this.index-b}else this.colno--}current(){return this.isFinished()?"":this.str.charAt(this.index)}currentStr(){return this.isFinished()?"":this.str.substr(this.index)}previous(){return this.str.charAt(this.index-1)}}L.exports={lex(b,c){return new U(b,c)},TOKEN_STRING:m,TOKEN_WHITESPACE:n,TOKEN_DATA:o,TOKEN_BLOCK_START:p,TOKEN_BLOCK_END:q,TOKEN_VARIABLE_START:r,TOKEN_VARIABLE_END:s,TOKEN_COMMENT:t,TOKEN_LEFT_PAREN:u,TOKEN_RIGHT_PAREN:v,TOKEN_LEFT_BRACKET:w,TOKEN_RIGHT_BRACKET:x,TOKEN_LEFT_CURLY:y,TOKEN_RIGHT_CURLY:z,TOKEN_OPERATOR:A,TOKEN_COMMA:B,TOKEN_COLON:C,TOKEN_TILDE:D,TOKEN_PIPE:E,TOKEN_INT:F,TOKEN_FLOAT:G,TOKEN_BOOLEAN:H,TOKEN_NONE:i,TOKEN_SYMBOL:I,TOKEN_SPECIAL:T,TOKEN_REGEX:J}},16(n,i){"use strict";const j=require("events"),g=k$(11);function k(a,b){return typeof a!=="function"||typeof b!=="function"?b:function c(){const e=this.parent;this.parent=a;const d=b.apply(this,arguments);return this.parent=e,d}}function h(a,b,c){c=c||{},g.keys(c).forEach(d=>{c[d]=k(a.prototype[d],c[d])});class e extends a{get typename(){return b}}return g._assign(e.prototype,c),e}class l{constructor(...a){this.init(...a)}init(){}get typename(){return this.constructor.name}static extend(a,b){return typeof a==="object"&&(b=a,a="anonymous"),h(this,a,b)}}class m extends j{constructor(...a){super();this.init(...a)}init(){}get typename(){return this.constructor.name}static extend(a,b){return typeof a==="object"&&(b=a,a="anonymous"),h(this,a,b)}}i.exports={Obj:l,EmitterObj:m}},15(qa,x){"use strict";const{Obj:y}=k$(16);function p(a,b,d){a instanceof b&&d.push(a),a instanceof c&&a.findAll(b,d)}class c extends y{init(a,b,...d){this.lineno=a,this.colno=b,this.fields.forEach((e,g)=>{var h=arguments[g+2];h===void 0&&(h=null),this[e]=h})}findAll(a,b){return b=b||[],this instanceof i?this.children.forEach(d=>p(d,a,b)):this.fields.forEach(d=>p(this[d],a,b)),b}iterFields(a){this.fields.forEach(b=>{a(this[b],b)})}}class l extends c{get typename(){return"Value"}get fields(){return["value"]}}class i extends c{get typename(){return"NodeList"}get fields(){return["children"]}init(a,b,d){super.init(a,b,d||[])}addChild(a){this.children.push(a)}}const z=i.extend("Root"),q=l.extend("Literal"),A=l.extend("Symbol"),B=i.extend("Group"),C=i.extend("Array"),D=c.extend("Pair",{fields:["key","value"]}),r=i.extend("Dict"),E=c.extend("LookupVal",{fields:["target","val"]}),s=c.extend("If",{fields:["cond","body","else_"]}),F=s.extend("IfAsync"),G=c.extend("InlineIf",{fields:["cond","body","else_"]}),m=c.extend("For",{fields:["arr","name","body","else_"]}),H=m.extend("AsyncEach"),I=m.extend("AsyncAll"),t=c.extend("Macro",{fields:["name","args","body"]}),J=t.extend("Caller"),K=c.extend("Import",{fields:["template","target","withContext"]});class L extends c{get typename(){return"FromImport"}get fields(){return["template","names","withContext"]}init(a,b,d,e,g){super.init(a,b,d,e||new i(),g)}}const u=c.extend("FunCall",{fields:["name","args"]}),v=u.extend("Filter"),M=v.extend("FilterAsync",{fields:["name","args","symbol"]}),N=r.extend("KeywordArgs"),O=c.extend("Block",{fields:["name","body"]}),P=c.extend("Super",{fields:["blockName","symbol"]}),Q=c.extend("TemplateRef",{fields:["template"]}),R=Q.extend("Extends"),S=c.extend("Include",{fields:["template","ignoreMissing"]}),T=c.extend("Set",{fields:["targets","value"]}),U=c.extend("Switch",{fields:["expr","cases","default"]}),V=c.extend("Case",{fields:["cond","body"]}),W=i.extend("Output"),X=c.extend("Capture",{fields:["body"]}),Y=q.extend("TemplateData"),n=c.extend("UnaryOp",{fields:["target"]}),f=c.extend("BinOp",{fields:["left","right"]}),Z=f.extend("In"),_=f.extend("Is"),$=f.extend("Or"),aa=f.extend("And"),ba=n.extend("Not"),ca=f.extend("Add"),da=f.extend("Concat"),ea=f.extend("Sub"),fa=f.extend("Mul"),ga=f.extend("Div"),ha=f.extend("FloorDiv"),ia=f.extend("Mod"),ja=f.extend("Pow"),ka=n.extend("Neg"),la=n.extend("Pos"),ma=c.extend("Compare",{fields:["expr","ops"]}),na=c.extend("CompareOperand",{fields:["expr","type"]}),o=c.extend("CallExtension",{init(a,b,d,e){this.parent(),this.extName=a.__name||a,this.prop=b,this.args=d||new i(),this.contentArgs=e||[],this.autoescape=a.autoescape},fields:["extName","prop","args","contentArgs"]}),oa=o.extend("CallExtensionAsync");function j(a,b,d){var e=a.split(`
`);e.forEach((g,h)=>{g&&(d&&h>0||!d)&&process.stdout.write(" ".repeat(b));const pa=h===e.length-1?"":`
`;process.stdout.write(`${g}${pa}`)})}function k(a,b){b=b||0,j(a.typename+": ",b);if(a instanceof i)j(`
`),a.children.forEach(d=>{k(d,b+2)});else if(a instanceof o)j(`${a.extName}.${a.prop}
`),a.args&&k(a.args,b+2),a.contentArgs&&a.contentArgs.forEach(d=>{k(d,b+2)});else{let d=[],e=null;a.iterFields((g,h)=>{g instanceof c?d.push([h,g]):(e=e||{},e[h]=g)}),e?j(JSON.stringify(e,null,2)+`
`,null,!0):j(`
`),d.forEach(([g,h])=>{j(`[${g}] =>`,b+2),k(h,b+4)})}}x.exports={Node:c,Root:z,NodeList:i,Value:l,Literal:q,Symbol:A,Group:B,Array:C,Pair:D,Dict:r,Output:W,Capture:X,TemplateData:Y,If:s,IfAsync:F,InlineIf:G,For:m,AsyncEach:H,AsyncAll:I,Macro:t,Caller:J,Import:K,FromImport:L,FunCall:u,Filter:v,FilterAsync:M,KeywordArgs:N,Block:O,Super:P,Extends:R,Include:S,Set:T,Switch:U,Case:V,LookupVal:E,BinOp:f,In:Z,Is:_,Or:$,And:aa,Not:ba,Add:ca,Concat:da,Sub:ea,Mul:fa,Div:ga,FloorDiv:ha,Mod:ia,Pow:ja,Neg:ka,Pos:la,Compare:ma,CompareOperand:na,CallExtension:o,CallExtensionAsync:oa,printNodes:k}},17(s,p){"use strict";var f=k$(10),d=k$(15),q=k$(16).Obj,n=k$(11);class o extends q{init(a){this.tokens=a,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]}nextToken(a){var b;if(this.peeked)if(!a&&this.peeked.type===f.TOKEN_WHITESPACE)this.peeked=null;else return b=this.peeked,this.peeked=null,b;b=this.tokens.nextToken();if(!a)for(;b&&b.type===f.TOKEN_WHITESPACE;)b=this.tokens.nextToken();return b}peekToken(){return this.peeked=this.peeked||this.nextToken(),this.peeked}pushToken(a){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=a}error(a,b,c){if(b===void 0||c===void 0){const e=this.peekToken()||{};b=e.lineno,c=e.colno}return b!==void 0&&(b+=1),c!==void 0&&(c+=1),new n.TemplateError(a,b,c)}fail(a,b,c){throw this.error(a,b,c)}skip(a){var b=this.nextToken();return!b||b.type!==a?(this.pushToken(b),!1):!0}expect(a){var b=this.nextToken();return b.type!==a&&this.fail("expected "+a+", got "+b.type,b.lineno,b.colno),b}skipValue(a,b){var c=this.nextToken();return!c||c.type!==a||c.value!==b?(this.pushToken(c),!1):!0}skipSymbol(a){return this.skipValue(f.TOKEN_SYMBOL,a)}advanceAfterBlockEnd(a){var b;return a||(b=this.peekToken(),b||this.fail("unexpected end of file"),b.type!==f.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),a=this.nextToken().value),b=this.nextToken(),b&&b.type===f.TOKEN_BLOCK_END?b.value.charAt(0)==="-"&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+a+" statement"),b}advanceAfterVariableEnd(){var a=this.nextToken();a&&a.type===f.TOKEN_VARIABLE_END?this.dropLeadingWhitespace=a.value.charAt(a.value.length-this.tokens.tags.VARIABLE_END.length-1)==="-":(this.pushToken(a),this.fail("expected variable end"))}parseFor(){var a=this.peekToken(),b,c;this.skipSymbol("for")?(b=new d.For(a.lineno,a.colno),c="endfor"):this.skipSymbol("asyncEach")?(b=new d.AsyncEach(a.lineno,a.colno),c="endeach"):this.skipSymbol("asyncAll")?(b=new d.AsyncAll(a.lineno,a.colno),c="endall"):this.fail("parseFor: expected for{Async}",a.lineno,a.colno),b.name=this.parsePrimary(),b.name instanceof d.Symbol||this.fail("parseFor: variable name expected for loop");const e=this.peekToken().type;if(e===f.TOKEN_COMMA){const g=b.name;for(b.name=new d.Array(g.lineno,g.colno),b.name.addChild(g);this.skip(f.TOKEN_COMMA);){const i=this.parsePrimary();b.name.addChild(i)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',a.lineno,a.colno),b.arr=this.parseExpression(),this.advanceAfterBlockEnd(a.value),b.body=this.parseUntilBlocks(c,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),b.else_=this.parseUntilBlocks(c)),this.advanceAfterBlockEnd(),b}parseMacro(){const a=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");const b=this.parsePrimary(!0),c=this.parseSignature(),e=new d.Macro(a.lineno,a.colno,b,c);return this.advanceAfterBlockEnd(a.value),e.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),e}parseCall(){var a=this.peekToken();this.skipSymbol("call")||this.fail("expected call");const b=this.parseSignature(!0)||new d.NodeList(),c=this.parsePrimary();this.advanceAfterBlockEnd(a.value);const e=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();const g=new d.Symbol(a.lineno,a.colno,"caller"),i=new d.Caller(a.lineno,a.colno,g,b,e),h=c.args.children;h[h.length-1]instanceof d.KeywordArgs||h.push(new d.KeywordArgs());const j=h[h.length-1];return j.addChild(new d.Pair(a.lineno,a.colno,g,i)),new d.Output(a.lineno,a.colno,[c])}parseWithContext(){var a=this.peekToken(),b=null;return this.skipSymbol("with")?b=!0:this.skipSymbol("without")&&(b=!1),b!==null&&(this.skipSymbol("context")||this.fail("parseFrom: expected context after with/without",a.lineno,a.colno)),b}parseImport(){var a=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",a.lineno,a.colno);const b=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',a.lineno,a.colno);const c=this.parseExpression(),e=this.parseWithContext(),g=new d.Import(a.lineno,a.colno,b,c,e);return this.advanceAfterBlockEnd(a.value),g}parseFrom(){const a=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");const b=this.parseExpression();this.skipSymbol("import")||this.fail("parseFrom: expected import",a.lineno,a.colno);const c=new d.NodeList();let e;for(;;){const g=this.peekToken();if(g.type===f.TOKEN_BLOCK_END){c.children.length||this.fail("parseFrom: Expected at least one import name",a.lineno,a.colno),g.value.charAt(0)==="-"&&(this.dropLeadingWhitespace=!0),this.nextToken();break}c.children.length>0&&!this.skip(f.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",a.lineno,a.colno);const i=this.parsePrimary();i.value.charAt(0)==="_"&&this.fail("parseFrom: names starting with an underscore cannot be imported",i.lineno,i.colno);if(this.skipSymbol("as")){const h=this.parsePrimary();c.addChild(new d.Pair(i.lineno,i.colno,i,h))}else c.addChild(i);e=this.parseWithContext()}return new d.FromImport(a.lineno,a.colno,b,c,e)}parseBlock(){const a=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",a.lineno,a.colno);const b=new d.Block(a.lineno,a.colno);b.name=this.parsePrimary(),b.name instanceof d.Symbol||this.fail("parseBlock: variable name expected",a.lineno,a.colno),this.advanceAfterBlockEnd(a.value),b.body=this.parseUntilBlocks("endblock"),this.skipSymbol("endblock"),this.skipSymbol(b.name.value);const c=this.peekToken();return c||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(c.value),b}parseExtends(){const a="extends",b=this.peekToken();this.skipSymbol(a)||this.fail("parseTemplateRef: expected "+a);const c=new d.Extends(b.lineno,b.colno);return c.template=this.parseExpression(),this.advanceAfterBlockEnd(b.value),c}parseInclude(){const a="include",b=this.peekToken();this.skipSymbol(a)||this.fail("parseInclude: expected "+a);const c=new d.Include(b.lineno,b.colno);return c.template=this.parseExpression(),this.skipSymbol("ignore")&&this.skipSymbol("missing")&&(c.ignoreMissing=!0),this.advanceAfterBlockEnd(b.value),c}parseIf(){const a=this.peekToken();let b;this.skipSymbol("if")||this.skipSymbol("elif")||this.skipSymbol("elseif")?b=new d.If(a.lineno,a.colno):this.skipSymbol("ifAsync")?b=new d.IfAsync(a.lineno,a.colno):this.fail("parseIf: expected if, elif, or elseif",a.lineno,a.colno),b.cond=this.parseExpression(),this.advanceAfterBlockEnd(a.value),b.body=this.parseUntilBlocks("elif","elseif","else","endif");const c=this.peekToken();switch(c&&c.value){case"elseif":case"elif":b.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),b.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":b.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected elif, else, or endif, got end of file")}return b}parseSet(){const a=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",a.lineno,a.colno);const b=new d.Set(a.lineno,a.colno,[]);let c;for(;c=this.parsePrimary();){b.targets.push(c);if(!this.skip(f.TOKEN_COMMA))break}return this.skipValue(f.TOKEN_OPERATOR,"=")?(b.value=this.parseExpression(),this.advanceAfterBlockEnd(a.value)):this.skip(f.TOKEN_BLOCK_END)?(b.body=new d.Capture(a.lineno,a.colno,this.parseUntilBlocks("endset")),b.value=null,this.advanceAfterBlockEnd()):this.fail("parseSet: expected = or block end in set tag",a.lineno,a.colno),b}parseSwitch(){const a="switch",b="endswitch",c="case",e="default",g=this.peekToken();!this.skipSymbol(a)&&!this.skipSymbol(c)&&!this.skipSymbol(e)&&this.fail('parseSwitch: expected "switch," "case" or "default"',g.lineno,g.colno);const i=this.parseExpression();this.advanceAfterBlockEnd(a),this.parseUntilBlocks(c,e,b);let h=this.peekToken();const j=[];let k;do{this.skipSymbol(c);const m=this.parseExpression();this.advanceAfterBlockEnd(a);const r=this.parseUntilBlocks(c,e,b);j.push(new d.Case(h.line,h.col,m,r)),h=this.peekToken()}while(h&&h.value===c);switch(h.value){case e:this.advanceAfterBlockEnd(),k=this.parseUntilBlocks(b),this.advanceAfterBlockEnd();break;case b:this.advanceAfterBlockEnd();break;default:this.fail('parseSwitch: expected "case," "default" or "endswitch," got EOF.')}return new d.Switch(g.lineno,g.colno,i,j,k)}parseStatement(){var a=this.peekToken(),b;a.type!==f.TOKEN_SYMBOL&&this.fail("tag name expected",a.lineno,a.colno);if(this.breakOnBlocks&&n.indexOf(this.breakOnBlocks,a.value)!==-1)return null;switch(a.value){case"raw":return this.parseRaw();case"verbatim":return this.parseRaw("verbatim");case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();case"filter":return this.parseFilterStatement();case"switch":return this.parseSwitch();default:if(this.extensions.length)for(let c=0;c<this.extensions.length;c++){const e=this.extensions[c];if(n.indexOf(e.tags||[],a.value)!==-1)return e.parse(this,d,f)}this.fail("unknown block tag: "+a.value,a.lineno,a.colno)}return b}parseRaw(a){a=a||"raw";const b="end"+a,c=new RegExp("([\\s\\S]*?){%\\s*("+a+"|"+b+")\\s*(?=%})%}");let e=1,g="",i=null;const h=this.advanceAfterBlockEnd();for(;(i=this.tokens._extractRegex(c))&&e>0;){const j=i[0],k=i[1],m=i[2];m===a?e+=1:m===b&&(e-=1),e===0?(g+=k,this.tokens.backN(j.length-k.length)):g+=j}return new d.Output(h.lineno,h.colno,[new d.TemplateData(h.lineno,h.colno,g)])}parsePostfix(a){let b,c=this.peekToken();for(;c;){if(c.type===f.TOKEN_LEFT_PAREN)a=new d.FunCall(c.lineno,c.colno,a,this.parseSignature());else if(c.type===f.TOKEN_LEFT_BRACKET)b=this.parseAggregate(),b.children.length>1&&this.fail("invalid index"),a=new d.LookupVal(c.lineno,c.colno,a,b.children[0]);else if(c.type===f.TOKEN_OPERATOR&&c.value==="."){this.nextToken();const e=this.nextToken();e.type!==f.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+e.value,e.lineno,e.colno),b=new d.Literal(e.lineno,e.colno,e.value),a=new d.LookupVal(c.lineno,c.colno,a,b)}else break;c=this.peekToken()}return a}parseExpression(){var a=this.parseInlineIf();return a}parseInlineIf(){let a=this.parseOr();if(this.skipSymbol("if")){const b=this.parseOr(),c=a;a=new d.InlineIf(a.lineno,a.colno),a.body=c,a.cond=b,this.skipSymbol("else")?a.else_=this.parseOr():a.else_=null}return a}parseOr(){let a=this.parseAnd();for(;this.skipSymbol("or");){const b=this.parseAnd();a=new d.Or(a.lineno,a.colno,a,b)}return a}parseAnd(){let a=this.parseNot();for(;this.skipSymbol("and");){const b=this.parseNot();a=new d.And(a.lineno,a.colno,a,b)}return a}parseNot(){const a=this.peekToken();return this.skipSymbol("not")?new d.Not(a.lineno,a.colno,this.parseNot()):this.parseIn()}parseIn(){let a=this.parseIs();for(;;){const b=this.nextToken();if(!b)break;const c=b.type===f.TOKEN_SYMBOL&&b.value==="not";c||this.pushToken(b);if(this.skipSymbol("in")){const e=this.parseIs();a=new d.In(a.lineno,a.colno,a,e),c&&(a=new d.Not(a.lineno,a.colno,a))}else{c&&this.pushToken(b);break}}return a}parseIs(){let a=this.parseCompare();if(this.skipSymbol("is")){const b=this.skipSymbol("not"),c=this.parseCompare();a=new d.Is(a.lineno,a.colno,a,c),b&&(a=new d.Not(a.lineno,a.colno,a))}return a}parseCompare(){const a=["==","===","!=","!==","<",">","<=",">="],b=this.parseConcat(),c=[];for(;;){const e=this.nextToken();if(e)if(a.indexOf(e.value)!==-1)c.push(new d.CompareOperand(e.lineno,e.colno,this.parseConcat(),e.value));else{this.pushToken(e);break}else break}return c.length?new d.Compare(c[0].lineno,c[0].colno,b,c):b}parseConcat(){let a=this.parseAdd();for(;this.skipValue(f.TOKEN_TILDE,"~");){const b=this.parseAdd();a=new d.Concat(a.lineno,a.colno,a,b)}return a}parseAdd(){let a=this.parseSub();for(;this.skipValue(f.TOKEN_OPERATOR,"+");){const b=this.parseSub();a=new d.Add(a.lineno,a.colno,a,b)}return a}parseSub(){let a=this.parseMul();for(;this.skipValue(f.TOKEN_OPERATOR,"-");){const b=this.parseMul();a=new d.Sub(a.lineno,a.colno,a,b)}return a}parseMul(){let a=this.parseDiv();for(;this.skipValue(f.TOKEN_OPERATOR,"*");){const b=this.parseDiv();a=new d.Mul(a.lineno,a.colno,a,b)}return a}parseDiv(){let a=this.parseFloorDiv();for(;this.skipValue(f.TOKEN_OPERATOR,"/");){const b=this.parseFloorDiv();a=new d.Div(a.lineno,a.colno,a,b)}return a}parseFloorDiv(){let a=this.parseMod();for(;this.skipValue(f.TOKEN_OPERATOR,"//");){const b=this.parseMod();a=new d.FloorDiv(a.lineno,a.colno,a,b)}return a}parseMod(){let a=this.parsePow();for(;this.skipValue(f.TOKEN_OPERATOR,"%");){const b=this.parsePow();a=new d.Mod(a.lineno,a.colno,a,b)}return a}parsePow(){let a=this.parseUnary();for(;this.skipValue(f.TOKEN_OPERATOR,"**");){const b=this.parseUnary();a=new d.Pow(a.lineno,a.colno,a,b)}return a}parseUnary(a){const b=this.peekToken();let c;return this.skipValue(f.TOKEN_OPERATOR,"-")?c=new d.Neg(b.lineno,b.colno,this.parseUnary(!0)):this.skipValue(f.TOKEN_OPERATOR,"+")?c=new d.Pos(b.lineno,b.colno,this.parseUnary(!0)):c=this.parsePrimary(),a||(c=this.parseFilter(c)),c}parsePrimary(a){const b=this.nextToken();let c,e=null;b?b.type===f.TOKEN_STRING?c=b.value:b.type===f.TOKEN_INT?c=parseInt(b.value,10):b.type===f.TOKEN_FLOAT?c=parseFloat(b.value):b.type===f.TOKEN_BOOLEAN?b.value==="true"?c=!0:b.value==="false"?c=!1:this.fail("invalid boolean: "+b.value,b.lineno,b.colno):b.type===f.TOKEN_NONE?c=null:b.type===f.TOKEN_REGEX&&(c=new RegExp(b.value.body,b.value.flags)):this.fail("expected expression, got end of file"),c!==void 0?e=new d.Literal(b.lineno,b.colno,c):b.type===f.TOKEN_SYMBOL?e=new d.Symbol(b.lineno,b.colno,b.value):(this.pushToken(b),e=this.parseAggregate()),a||(e=this.parsePostfix(e));if(e)return e;throw this.error(`unexpected token: ${b.value}`,b.lineno,b.colno)}parseFilterName(){const a=this.expect(f.TOKEN_SYMBOL);let b=a.value;for(;this.skipValue(f.TOKEN_OPERATOR,".");)b+="."+this.expect(f.TOKEN_SYMBOL).value;return new d.Symbol(a.lineno,a.colno,b)}parseFilterArgs(a){if(this.peekToken().type===f.TOKEN_LEFT_PAREN){const b=this.parsePostfix(a);return b.args.children}return[]}parseFilter(a){for(;this.skip(f.TOKEN_PIPE);){const b=this.parseFilterName();a=new d.Filter(b.lineno,b.colno,b,new d.NodeList(b.lineno,b.colno,[a].concat(this.parseFilterArgs(a))))}return a}parseFilterStatement(){var a=this.peekToken();this.skipSymbol("filter")||this.fail("parseFilterStatement: expected filter");const b=this.parseFilterName(),c=this.parseFilterArgs(b);this.advanceAfterBlockEnd(a.value);const e=new d.Capture(b.lineno,b.colno,this.parseUntilBlocks("endfilter"));this.advanceAfterBlockEnd();const g=new d.Filter(b.lineno,b.colno,b,new d.NodeList(b.lineno,b.colno,[e].concat(c)));return new d.Output(b.lineno,b.colno,[g])}parseAggregate(){var a=this.nextToken(),b;switch(a.type){case f.TOKEN_LEFT_PAREN:b=new d.Group(a.lineno,a.colno);break;case f.TOKEN_LEFT_BRACKET:b=new d.Array(a.lineno,a.colno);break;case f.TOKEN_LEFT_CURLY:b=new d.Dict(a.lineno,a.colno);break;default:return null}for(;;){const c=this.peekToken().type;if(c===f.TOKEN_RIGHT_PAREN||c===f.TOKEN_RIGHT_BRACKET||c===f.TOKEN_RIGHT_CURLY){this.nextToken();break}b.children.length>0&&(this.skip(f.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",a.lineno,a.colno));if(b instanceof d.Dict){const e=this.parsePrimary();this.skip(f.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",a.lineno,a.colno);const g=this.parseExpression();b.addChild(new d.Pair(e.lineno,e.colno,e,g))}else{const e=this.parseExpression();b.addChild(e)}}return b}parseSignature(a,b){let c=this.peekToken();if(!b&&c.type!==f.TOKEN_LEFT_PAREN){if(a)return null;this.fail("expected arguments",c.lineno,c.colno)}c.type===f.TOKEN_LEFT_PAREN&&(c=this.nextToken());const e=new d.NodeList(c.lineno,c.colno),g=new d.KeywordArgs(c.lineno,c.colno);let i=!1;for(;;){c=this.peekToken();if(!b&&c.type===f.TOKEN_RIGHT_PAREN){this.nextToken();break}else if(b&&c.type===f.TOKEN_BLOCK_END)break;if(i&&!this.skip(f.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",c.lineno,c.colno);else{const h=this.parseExpression();this.skipValue(f.TOKEN_OPERATOR,"=")?g.addChild(new d.Pair(h.lineno,h.colno,h,this.parseExpression())):e.addChild(h)}i=!0}return g.children.length&&e.addChild(g),e}parseUntilBlocks(...a){const b=this.breakOnBlocks;this.breakOnBlocks=a;const c=this.parse();return this.breakOnBlocks=b,c}parseNodes(){let a;const b=[];for(;a=this.nextToken();)if(a.type===f.TOKEN_DATA){let c=a.value;const e=this.peekToken(),g=e&&e.value;this.dropLeadingWhitespace&&(c=c.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),e&&(e.type===f.TOKEN_BLOCK_START&&g.charAt(g.length-1)==="-"||e.type===f.TOKEN_VARIABLE_START&&g.charAt(this.tokens.tags.VARIABLE_START.length)==="-"||e.type===f.TOKEN_COMMENT&&g.charAt(this.tokens.tags.COMMENT_START.length)==="-")&&(c=c.replace(/\s*$/,"")),b.push(new d.Output(a.lineno,a.colno,[new d.TemplateData(a.lineno,a.colno,c)]))}else if(a.type===f.TOKEN_BLOCK_START){this.dropLeadingWhitespace=!1;const c=this.parseStatement();if(!c)break;b.push(c)}else if(a.type===f.TOKEN_VARIABLE_START){const c=this.parseExpression();this.dropLeadingWhitespace=!1,this.advanceAfterVariableEnd(),b.push(new d.Output(a.lineno,a.colno,[c]))}else a.type===f.TOKEN_COMMENT?this.dropLeadingWhitespace=a.value.charAt(a.value.length-this.tokens.tags.COMMENT_END.length-1)==="-":this.fail("Unexpected token at top-level: "+a.type,a.lineno,a.colno);return b}parse(){return new d.NodeList(0,0,this.parseNodes())}parseAsRoot(){return new d.Root(0,0,this.parseNodes())}}p.exports={parse(a,b,c){var e=new o(f.lex(a,c));return b!==void 0&&(e.extensions=b),e.parseAsRoot()},Parser:o}},23(w,o){"use strict";var c=k$(15),p=k$(11),q=0;function n(){return"hole_"+q++}function k(a,b){var d=null;for(let e=0;e<a.length;e++){const g=b(a[e]);g!==a[e]&&(d||(d=a.slice()),d[e]=g)}return d||a}function h(a,b,d){if(!(a instanceof c.Node))return a;if(!d){const e=b(a);if(e&&e!==a)return e}if(a instanceof c.NodeList){const e=k(a.children,g=>h(g,b,d));e!==a.children&&(a=new c[a.typename](a.lineno,a.colno,e))}else if(a instanceof c.CallExtension){const e=h(a.args,b,d),g=k(a.contentArgs,f=>h(f,b,d));(e!==a.args||g!==a.contentArgs)&&(a=new c[a.typename](a.extName,a.prop,e,g))}else{const e=a.fields.map(f=>a[f]),g=k(e,f=>h(f,b,d));g!==e&&(a=new c[a.typename](a.lineno,a.colno),g.forEach((f,j)=>{a[a.fields[j]]=f}))}return d?b(a)||a:a}function l(a,b){return h(a,b,!0)}function i(a,b,d){var e=[],g=l(d?a[d]:a,f=>{let j;return f instanceof c.Block?f:((f instanceof c.Filter&&p.indexOf(b,f.name.value)!==-1||f instanceof c.CallExtensionAsync)&&(j=new c.Symbol(f.lineno,f.colno,n()),e.push(new c.FilterAsync(f.lineno,f.colno,f.name,f.args,j))),j)});return d?a[d]=g:a=g,e.length?(e.push(a),new c.NodeList(a.lineno,a.colno,e)):a}function r(a,b){return l(a,d=>d instanceof c.Output?i(d,b):d instanceof c.Set?i(d,b,"value"):d instanceof c.For?i(d,b,"arr"):d instanceof c.If?i(d,b,"cond"):d instanceof c.CallExtension?i(d,b,"args"):void 0)}function s(a){return h(a,b=>{if(!(b instanceof c.Block))return;let d=!1;const e=n();b.body=h(b.body,g=>{if(g instanceof c.FunCall&&g.name.value==="super")return d=!0,new c.Symbol(g.lineno,g.colno,e)}),d&&b.body.children.unshift(new c.Super(0,0,b.name,new c.Symbol(0,0,e)))})}function t(a){return l(a,b=>{if(!(b instanceof c.If)&&!(b instanceof c.For))return;let d=!1;h(b,e=>e instanceof c.FilterAsync||e instanceof c.IfAsync||e instanceof c.AsyncEach||e instanceof c.AsyncAll||e instanceof c.CallExtensionAsync?(d=!0,e):void 0);if(d){if(b instanceof c.If)return new c.IfAsync(b.lineno,b.colno,b.cond,b.body,b.else_);if(b instanceof c.For&&!(b instanceof c.AsyncAll))return new c.AsyncEach(b.lineno,b.colno,b.arr,b.name,b.body,b.else_)}return})}function u(a,b){return t(s(r(a,b)))}function v(a,b){return u(a,b||[])}o.exports={transform:v}},21(I,s){"use strict";var k=k$(11),m=Array.from,t=typeof Symbol==="function"&&Symbol.iterator&&typeof m==="function";class n{constructor(a,b){this.variables={},this.parent=a,this.topLevel=!1,this.isolateWrites=b}set(a,b,c){var d=a.split("."),h=this.variables,e=this;if(c){if(e=this.resolve(d[0],!0)){e.set(a,b);return}}for(let g=0;g<d.length-1;g++){const i=d[g];h[i]||(h[i]={}),h=h[i]}h[d[d.length-1]]=b}get(a){var b=this.variables[a];return b!==void 0?b:null}lookup(a){var b=this.parent,c=this.variables[a];return c!==void 0?c:b&&b.lookup(a)}resolve(a,b){var c=b&&this.isolateWrites?void 0:this.parent,d=this.variables[a];return d!==void 0?this:c&&c.resolve(a)}push(a){return new n(this,a)}pop(){return this.parent}}function u(a,b,c){return(...d)=>{var h=p(d),e,g=w(d);if(h>a.length)e=d.slice(0,a.length),d.slice(e.length,h).forEach((i,f)=>{f<b.length&&(g[b[f]]=i)}),e.push(g);else if(h<a.length){e=d.slice(0,h);for(let i=h;i<a.length;i++){const f=a[i];e.push(g[f]),delete g[f]}e.push(g)}else e=d;return c.apply(this,e)}}function v(a){return a.__keywords=!0,a}function o(a){return a&&Object.prototype.hasOwnProperty.call(a,"__keywords")}function w(a){var b=a.length;if(b){const c=a[b-1];if(o(c))return c}return{}}function p(a){var b=a.length;if(b===0)return 0;const c=a[b-1];return o(c)?b-1:b}function l(a){if(typeof a!=="string")return a;this.val=a,this.length=a.length}l.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),l.prototype.valueOf=function a(){return this.val},l.prototype.toString=function a(){return this.val};function x(a,b){return a instanceof l?new l(b):b.toString()}function y(a){var b=typeof a;return b==="string"?new l(a):b!=="function"?a:function c(d){var h=a.apply(this,arguments);return typeof h==="string"?new l(h):h}}function z(a,b){return a=a!==void 0&&a!==null?a:"",b&&!(a instanceof l)&&(a=k.escape(a.toString())),a}function A(a,b,c){if(a===null||a===void 0)throw new k.TemplateError("attempted to output null or undefined value",b+1,c+1);return a}function B(a,b){return a===void 0||a===null?void 0:typeof a[b]==="function"?(...c)=>a[b].apply(a,c):a[b]}function C(a,b,c,d){if(a){if(typeof a!=="function")throw new Error("Unable to call `"+b+"`, which is not a function")}else throw new Error("Unable to call `"+b+"`, which is undefined or falsey");return a.apply(c,d)}function D(a,b,c){var d=b.lookup(c);return d!==void 0?d:a.lookup(c)}function E(a,b,c){return a.lineno?a:new k.TemplateError(a,b,c)}function F(a,b,c,d){if(k.isArray(a)){const h=a.length;k.asyncIter(a,function e(g,i,f){switch(b){case 1:c(g,i,h,f);break;case 2:c(g[0],g[1],i,h,f);break;case 3:c(g[0],g[1],g[2],i,h,f);break;default:g.push(i,h,f),c.apply(this,g)}},d)}else k.asyncFor(a,function h(e,g,i,f,j){c(e,g,i,f,j)},d)}function G(a,b,c,d){var h=0,e,g;function i(f,j){h++,g[f]=j,h===e&&d(null,g.join(""))}if(k.isArray(a)){e=a.length,g=new Array(e);if(e===0)d(null,"");else for(let f=0;f<a.length;f++){const j=a[f];switch(b){case 1:c(j,f,e,i);break;case 2:c(j[0],j[1],f,e,i);break;case 3:c(j[0],j[1],j[2],f,e,i);break;default:j.push(f,e,i),c.apply(this,j)}}}else{const f=k.keys(a||{});e=f.length,g=new Array(e);if(e===0)d(null,"");else for(let j=0;j<f.length;j++){const q=f[j];c(q,a[q],j,e,i)}}}function H(a){return typeof a!=="object"||a===null||k.isArray(a)?a:t&&Symbol.iterator in a?m(a):a}s.exports={Frame:n,makeMacro:u,makeKeywordArgs:v,numArgs:p,suppressValue:z,ensureDefined:A,memberLookup:B,contextOrFrameLookup:D,callWrap:C,handleError:E,isArray:k.isArray,keys:k.keys,SafeString:l,copySafeness:x,markSafe:y,asyncEach:F,asyncAll:G,inOperator:k.inOperator,fromIterator:H}},4(x,r){"use strict";const s=k$(17),t=k$(23),g=k$(15),{TemplateError:u}=k$(11),{Frame:p}=k$(21),{Obj:v}=k$(16),w={"==":"==","===":"===","!=":"!=","!==":"!==","<":"<",">":">","<=":"<=",">=":">="};class q extends v{init(a,b){this.templateName=a,this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this._scopeClosers="",this.inBlock=!1,this.throwOnUndefined=b}fail(a,b,c){throw b!==void 0&&(b+=1),c!==void 0&&(c+=1),new u(a,b,c)}_pushBuffer(){const a=this._tmpid();return this.bufferStack.push(this.buffer),this.buffer=a,this._emit(`var ${this.buffer} = "";`),a}_popBuffer(){this.buffer=this.bufferStack.pop()}_emit(a){this.codebuf.push(a)}_emitLine(a){this._emit(a+`
`)}_emitLines(...a){a.forEach(b=>this._emitLine(b))}_emitFuncBegin(a,b){this.buffer="output",this._scopeClosers="",this._emitLine(`function ${b}(env, context, frame, runtime, cb) {`),this._emitLine(`var lineno = ${a.lineno};`),this._emitLine(`var colno = ${a.colno};`),this._emitLine(`var ${this.buffer} = "";`),this._emitLine("try {")}_emitFuncEnd(a){a||this._emitLine("cb(null, "+this.buffer+");"),this._closeScopeLevels(),this._emitLine("} catch (e) {"),this._emitLine("  cb(runtime.handleError(e, lineno, colno));"),this._emitLine("}"),this._emitLine("}"),this.buffer=null}_addScopeLevel(){this._scopeClosers+="})"}_closeScopeLevels(){this._emitLine(this._scopeClosers+";"),this._scopeClosers=""}_withScopedSyntax(a){var b=this._scopeClosers;this._scopeClosers="",a.call(this),this._closeScopeLevels(),this._scopeClosers=b}_makeCallback(a){var b=this._tmpid();return"function("+b+(a?","+a:"")+`) {
if(`+b+") { cb("+b+"); return; }"}_tmpid(){return this.lastId++,"t_"+this.lastId}_templateName(){return this.templateName==null?"undefined":JSON.stringify(this.templateName)}_compileChildren(a,b){a.children.forEach(c=>{this.compile(c,b)})}_compileAggregate(a,b,c,d){c&&this._emit(c),a.children.forEach((e,f)=>{f>0&&this._emit(","),this.compile(e,b)}),d&&this._emit(d)}_compileExpression(a,b){this.assertType(a,g.Literal,g.Symbol,g.Group,g.Array,g.Dict,g.FunCall,g.Caller,g.Filter,g.LookupVal,g.Compare,g.InlineIf,g.In,g.Is,g.And,g.Or,g.Not,g.Add,g.Concat,g.Sub,g.Mul,g.Div,g.FloorDiv,g.Mod,g.Pow,g.Neg,g.Pos,g.Compare,g.NodeList),this.compile(a,b)}assertType(a,...b){b.some(c=>a instanceof c)||this.fail(`assertType: invalid type: ${a.typename}`,a.lineno,a.colno)}compileCallExtension(a,b,c){var d=a.args,e=a.contentArgs,f=typeof a.autoescape==="boolean"?a.autoescape:!0;c||this._emit(`${this.buffer} += runtime.suppressValue(`),this._emit(`env.getExtension("${a.extName}")["${a.prop}"](`),this._emit("context"),(d||e)&&this._emit(","),d&&(d instanceof g.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),d.children.forEach((h,k)=>{this._compileExpression(h,b),(k!==d.children.length-1||e.length)&&this._emit(",")})),e.length&&e.forEach((h,k)=>{k>0&&this._emit(",");if(h){this._emitLine("function(cb) {"),this._emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}");const i=this._pushBuffer();this._withScopedSyntax(()=>{this.compile(h,b),this._emitLine(`cb(null, ${i});`)}),this._popBuffer(),this._emitLine(`return ${i};`),this._emitLine("}")}else this._emit("null")});if(c){const h=this._tmpid();this._emitLine(", "+this._makeCallback(h)),this._emitLine(`${this.buffer} += runtime.suppressValue(${h}, ${f} && env.opts.autoescape);`),this._addScopeLevel()}else this._emit(")"),this._emit(`, ${f} && env.opts.autoescape);
`)}compileCallExtensionAsync(a,b){this.compileCallExtension(a,b,!0)}compileNodeList(a,b){this._compileChildren(a,b)}compileLiteral(a){if(typeof a.value==="string"){let b=a.value.replace(/\\/g,"\\\\");b=b.replace(/"/g,'\\"'),b=b.replace(/\n/g,"\\n"),b=b.replace(/\r/g,"\\r"),b=b.replace(/\t/g,"\\t"),b=b.replace(/\u2028/g,"\\u2028"),this._emit(`"${b}"`)}else a.value===null?this._emit("null"):this._emit(a.value.toString())}compileSymbol(a,b){var c=a.value,d=b.lookup(c);d?this._emit(d):this._emit('runtime.contextOrFrameLookup(context, frame, "'+c+'")')}compileGroup(a,b){this._compileAggregate(a,b,"(",")")}compileArray(a,b){this._compileAggregate(a,b,"[","]")}compileDict(a,b){this._compileAggregate(a,b,"{","}")}compilePair(a,b){var c=a.key,d=a.value;c instanceof g.Symbol?c=new g.Literal(c.lineno,c.colno,c.value):c instanceof g.Literal&&typeof c.value==="string"||this.fail("compilePair: Dict keys must be strings or names",c.lineno,c.colno),this.compile(c,b),this._emit(": "),this._compileExpression(d,b)}compileInlineIf(a,b){this._emit("("),this.compile(a.cond,b),this._emit("?"),this.compile(a.body,b),this._emit(":"),a.else_!==null?this.compile(a.else_,b):this._emit('""'),this._emit(")")}compileIn(a,b){this._emit("runtime.inOperator("),this.compile(a.left,b),this._emit(","),this.compile(a.right,b),this._emit(")")}compileIs(a,b){var c=a.right.name?a.right.name.value:a.right.value;this._emit('env.getTest("'+c+'").call(context, '),this.compile(a.left,b),a.right.args&&(this._emit(","),this.compile(a.right.args,b)),this._emit(") === true")}_binOpEmitter(a,b,c){this.compile(a.left,b),this._emit(c),this.compile(a.right,b)}compileOr(a,b){return this._binOpEmitter(a,b," || ")}compileAnd(a,b){return this._binOpEmitter(a,b," && ")}compileAdd(a,b){return this._binOpEmitter(a,b," + ")}compileConcat(a,b){return this._binOpEmitter(a,b,' + "" + ')}compileSub(a,b){return this._binOpEmitter(a,b," - ")}compileMul(a,b){return this._binOpEmitter(a,b," * ")}compileDiv(a,b){return this._binOpEmitter(a,b," / ")}compileMod(a,b){return this._binOpEmitter(a,b," % ")}compileNot(a,b){this._emit("!"),this.compile(a.target,b)}compileFloorDiv(a,b){this._emit("Math.floor("),this.compile(a.left,b),this._emit(" / "),this.compile(a.right,b),this._emit(")")}compilePow(a,b){this._emit("Math.pow("),this.compile(a.left,b),this._emit(", "),this.compile(a.right,b),this._emit(")")}compileNeg(a,b){this._emit("-"),this.compile(a.target,b)}compilePos(a,b){this._emit("+"),this.compile(a.target,b)}compileCompare(a,b){this.compile(a.expr,b),a.ops.forEach(c=>{this._emit(` ${w[c.type]} `),this.compile(c.expr,b)})}compileLookupVal(a,b){this._emit("runtime.memberLookup(("),this._compileExpression(a.target,b),this._emit("),"),this._compileExpression(a.val,b),this._emit(")")}_getNodeName(a){switch(a.typename){case"Symbol":return a.value;case"FunCall":return"the return value of ("+this._getNodeName(a.name)+")";case"LookupVal":return this._getNodeName(a.target)+'["'+this._getNodeName(a.val)+'"]';case"Literal":return a.value.toString();default:return"--expression--"}}compileFunCall(a,b){this._emit("(lineno = "+a.lineno+", colno = "+a.colno+", "),this._emit("runtime.callWrap("),this._compileExpression(a.name,b),this._emit(', "'+this._getNodeName(a.name).replace(/"/g,'\\"')+'", context, '),this._compileAggregate(a.args,b,"[","])"),this._emit(")")}compileFilter(a,b){var c=a.name;this.assertType(c,g.Symbol),this._emit('env.getFilter("'+c.value+'").call(context, '),this._compileAggregate(a.args,b),this._emit(")")}compileFilterAsync(a,b){var c=a.name,d=a.symbol.value;this.assertType(c,g.Symbol),b.set(d,d),this._emit('env.getFilter("'+c.value+'").call(context, '),this._compileAggregate(a.args,b),this._emitLine(", "+this._makeCallback(d)),this._addScopeLevel()}compileKeywordArgs(a,b){this._emit("runtime.makeKeywordArgs("),this.compileDict(a,b),this._emit(")")}compileSet(a,b){var c=[];a.targets.forEach(d=>{var e=d.value,f=b.lookup(e);(f===null||f===void 0)&&(f=this._tmpid(),this._emitLine("var "+f+";")),c.push(f)}),a.value?(this._emit(c.join(" = ")+" = "),this._compileExpression(a.value,b),this._emitLine(";")):(this._emit(c.join(" = ")+" = "),this.compile(a.body,b),this._emitLine(";")),a.targets.forEach((d,e)=>{var f=c[e],h=d.value;this._emitLine(`frame.set("${h}", ${f}, true);`),this._emitLine("if(frame.topLevel) {"),this._emitLine(`context.setVariable("${h}", ${f});`),this._emitLine("}"),h.charAt(0)!=="_"&&(this._emitLine("if(frame.topLevel) {"),this._emitLine(`context.addExport("${h}", ${f});`),this._emitLine("}"))})}compileSwitch(a,b){this._emit("switch ("),this.compile(a.expr,b),this._emit(") {"),a.cases.forEach((c,d)=>{this._emit("case "),this.compile(c.cond,b),this._emit(": "),this.compile(c.body,b),c.body.children.length&&this._emitLine("break;")}),a.default&&(this._emit("default:"),this.compile(a.default,b)),this._emit("}")}compileIf(a,b,c){this._emit("if("),this._compileExpression(a.cond,b),this._emitLine(") {"),this._withScopedSyntax(()=>{this.compile(a.body,b),c&&this._emit("cb()")}),a.else_?(this._emitLine(`}
else {`),this._withScopedSyntax(()=>{this.compile(a.else_,b),c&&this._emit("cb()")})):c&&(this._emitLine(`}
else {`),this._emit("cb()")),this._emitLine("}")}compileIfAsync(a,b){this._emit("(function(cb) {"),this.compileIf(a,b,!0),this._emit("})("+this._makeCallback()),this._addScopeLevel()}_emitLoopBindings(a,b,c,d){const e=[{name:"index",val:`${c} + 1`},{name:"index0",val:c},{name:"revindex",val:`${d} - ${c}`},{name:"revindex0",val:`${d} - ${c} - 1`},{name:"first",val:`${c} === 0`},{name:"last",val:`${c} === ${d} - 1`},{name:"length",val:d}];e.forEach(f=>{this._emitLine(`frame.set("loop.${f.name}", ${f.val});`)})}compileFor(a,b){const c=this._tmpid(),d=this._tmpid(),e=this._tmpid();b=b.push(),this._emitLine("frame = frame.push();"),this._emit(`var ${e} = `),this._compileExpression(a.arr,b),this._emitLine(";"),this._emit(`if(${e}) {`),this._emitLine(e+" = runtime.fromIterator("+e+");");if(a.name instanceof g.Array){this._emitLine(`var ${c};`),this._emitLine(`if(runtime.isArray(${e})) {`),this._emitLine(`var ${d} = ${e}.length;`),this._emitLine(`for(${c}=0; ${c} < ${e}.length; ${c}++) {`),a.name.children.forEach((l,m)=>{var j=this._tmpid();this._emitLine(`var ${j} = ${e}[${c}][${m}];`),this._emitLine(`frame.set("${l}", ${e}[${c}][${m}]);`),b.set(a.name.children[m].value,j)}),this._emitLoopBindings(a,e,c,d),this._withScopedSyntax(()=>{this.compile(a.body,b)}),this._emitLine("}"),this._emitLine("} else {");const[f,h]=a.name.children,k=this._tmpid(),i=this._tmpid();b.set(f.value,k),b.set(h.value,i),this._emitLine(`${c} = -1;`),this._emitLine(`var ${d} = runtime.keys(${e}).length;`),this._emitLine(`for(var ${k} in ${e}) {`),this._emitLine(`${c}++;`),this._emitLine(`var ${i} = ${e}[${k}];`),this._emitLine(`frame.set("${f.value}", ${k});`),this._emitLine(`frame.set("${h.value}", ${i});`),this._emitLoopBindings(a,e,c,d),this._withScopedSyntax(()=>{this.compile(a.body,b)}),this._emitLine("}"),this._emitLine("}")}else{const f=this._tmpid();b.set(a.name.value,f),this._emitLine(`var ${d} = ${e}.length;`),this._emitLine(`for(var ${c}=0; ${c} < ${e}.length; ${c}++) {`),this._emitLine(`var ${f} = ${e}[${c}];`),this._emitLine(`frame.set("${a.name.value}", ${f});`),this._emitLoopBindings(a,e,c,d),this._withScopedSyntax(()=>{this.compile(a.body,b)}),this._emitLine("}")}this._emitLine("}"),a.else_&&(this._emitLine("if (!"+d+") {"),this.compile(a.else_,b),this._emitLine("}")),this._emitLine("frame = frame.pop();")}_compileAsyncLoop(a,b,c){var d=this._tmpid(),e=this._tmpid(),f=this._tmpid(),h=c?"asyncAll":"asyncEach";b=b.push(),this._emitLine("frame = frame.push();"),this._emit("var "+f+" = runtime.fromIterator("),this._compileExpression(a.arr,b),this._emitLine(");");if(a.name instanceof g.Array){const i=a.name.children.length;this._emit(`runtime.${h}(${f}, ${i}, function(`),a.name.children.forEach(l=>{this._emit(`${l.value},`)}),this._emit(d+","+e+",next) {"),a.name.children.forEach(l=>{const m=l.value;b.set(m,m),this._emitLine(`frame.set("${m}", ${m});`)})}else{const i=a.name.value;this._emitLine(`runtime.${h}(${f}, 1, function(${i}, ${d}, ${e},next) {`),this._emitLine('frame.set("'+i+'", '+i+");"),b.set(i,i)}this._emitLoopBindings(a,f,d,e),this._withScopedSyntax(()=>{let i;c&&(i=this._pushBuffer()),this.compile(a.body,b),this._emitLine("next("+d+(i?","+i:"")+");"),c&&this._popBuffer()});const k=this._tmpid();this._emitLine("}, "+this._makeCallback(k)),this._addScopeLevel(),c&&this._emitLine(this.buffer+" += "+k+";"),a.else_&&(this._emitLine("if (!"+f+".length) {"),this.compile(a.else_,b),this._emitLine("}")),this._emitLine("frame = frame.pop();")}compileAsyncEach(a,b){this._compileAsyncLoop(a,b)}compileAsyncAll(a,b){this._compileAsyncLoop(a,b,!0)}_compileMacro(a,b){var c=[],d=null,e="macro_"+this._tmpid(),f=b!==void 0;a.args.children.forEach((j,o)=>{o===a.args.children.length-1&&j instanceof g.Dict?d=j:(this.assertType(j,g.Symbol),c.push(j))});const h=[...c.map(j=>`l_${j.value}`),"kwargs"],k=c.map(j=>`"${j.value}"`),i=(d&&d.children||[]).map(j=>`"${j.key.value}"`);let l;f?l=b.push(!0):l=new p(),this._emitLines(`var ${e} = runtime.makeMacro(`,`[${k.join(", ")}], `,`[${i.join(", ")}], `,`function (${h.join(", ")}) {`,"var callerFrame = frame;","frame = "+(f?"frame.push(true);":"new runtime.Frame();"),"kwargs = kwargs || {};",'if (Object.prototype.hasOwnProperty.call(kwargs, "caller")) {','frame.set("caller", kwargs.caller); }'),c.forEach(j=>{this._emitLine(`frame.set("${j.value}", l_${j.value});`),l.set(j.value,`l_${j.value}`)}),d&&d.children.forEach(j=>{const o=j.key.value;this._emit(`frame.set("${o}", `),this._emit(`Object.prototype.hasOwnProperty.call(kwargs, "${o}")`),this._emit(` ? kwargs["${o}"] : `),this._compileExpression(j.value,l),this._emit(");")});const m=this._pushBuffer();return this._withScopedSyntax(()=>{this.compile(a.body,l)}),this._emitLine("frame = "+(f?"frame.pop();":"callerFrame;")),this._emitLine(`return new runtime.SafeString(${m});`),this._emitLine("});"),this._popBuffer(),e}compileMacro(a,b){var c=this._compileMacro(a),d=a.name.value;b.set(d,c),b.parent?this._emitLine(`frame.set("${d}", ${c});`):(a.name.value.charAt(0)!=="_"&&this._emitLine(`context.addExport("${d}");`),this._emitLine(`context.setVariable("${d}", ${c});`))}compileCaller(a,b){this._emit("(function (){");const c=this._compileMacro(a,b);this._emit(`return ${c};})()`)}_compileGetTemplate(a,b,c,d){const e=this._tmpid(),f=this._templateName(),h=this._makeCallback(e),k=c?"true":"false",i=d?"true":"false";return this._emit("env.getTemplate("),this._compileExpression(a.template,b),this._emitLine(`, ${k}, ${f}, ${i}, ${h}`),e}compileImport(a,b){const c=a.target.value,d=this._compileGetTemplate(a,b,!1,!1);this._addScopeLevel(),this._emitLine(d+".getExported("+(a.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(d)),this._addScopeLevel(),b.set(c,d),b.parent?this._emitLine(`frame.set("${c}", ${d});`):this._emitLine(`context.setVariable("${c}", ${d});`)}compileFromImport(a,b){const c=this._compileGetTemplate(a,b,!1,!1);this._addScopeLevel(),this._emitLine(c+".getExported("+(a.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(c)),this._addScopeLevel(),a.names.children.forEach(d=>{var e,f,h=this._tmpid();d instanceof g.Pair?(e=d.key.value,f=d.value.value):(e=d.value,f=e),this._emitLine(`if(Object.prototype.hasOwnProperty.call(${c}, "${e}")) {`),this._emitLine(`var ${h} = ${c}.${e};`),this._emitLine("} else {"),this._emitLine(`cb(new Error("cannot import '${e}'")); return;`),this._emitLine("}"),b.set(f,h),b.parent?this._emitLine(`frame.set("${f}", ${h});`):this._emitLine(`context.setVariable("${f}", ${h});`)})}compileBlock(a){var b=this._tmpid();this.inBlock||this._emit('(parentTemplate ? function(e, c, f, r, cb) { cb(""); } : '),this._emit(`context.getBlock("${a.name.value}")`),this.inBlock||this._emit(")"),this._emitLine("(env, context, frame, runtime, "+this._makeCallback(b)),this._emitLine(`${this.buffer} += ${b};`),this._addScopeLevel()}compileSuper(a,b){var c=a.blockName.value,d=a.symbol.value;const e=this._makeCallback(d);this._emitLine(`context.getSuper(env, "${c}", b_${c}, frame, runtime, ${e}`),this._emitLine(`${d} = runtime.markSafe(${d});`),this._addScopeLevel(),b.set(d,d)}compileExtends(a,b){var c=this._tmpid();const d=this._compileGetTemplate(a,b,!0,!1);this._emitLine(`parentTemplate = ${d}`),this._emitLine(`for(var ${c} in parentTemplate.blocks) {`),this._emitLine(`context.addBlock(${c}, parentTemplate.blocks[${c}]);`),this._emitLine("}"),this._addScopeLevel()}compileInclude(a,b){this._emitLine("var tasks = [];"),this._emitLine("tasks.push("),this._emitLine("function(callback) {");const c=this._compileGetTemplate(a,b,!1,a.ignoreMissing);this._emitLine(`callback(null,${c});});`),this._emitLine("});");const d=this._tmpid();this._emitLine("tasks.push("),this._emitLine("function(template, callback){"),this._emitLine("template.render(context.getVariables(), frame, "+this._makeCallback(d)),this._emitLine("callback(null,"+d+");});"),this._emitLine("});"),this._emitLine("tasks.push("),this._emitLine("function(result, callback){"),this._emitLine(`${this.buffer} += result;`),this._emitLine("callback(null);"),this._emitLine("});"),this._emitLine("env.waterfall(tasks, function(){"),this._addScopeLevel()}compileTemplateData(a,b){this.compileLiteral(a,b)}compileCapture(a,b){var c=this.buffer;this.buffer="output",this._emitLine("(function() {"),this._emitLine('var output = "";'),this._withScopedSyntax(()=>{this.compile(a.body,b)}),this._emitLine("return output;"),this._emitLine("})()"),this.buffer=c}compileOutput(a,b){const c=a.children;c.forEach(d=>{d instanceof g.TemplateData?d.value&&(this._emit(`${this.buffer} += `),this.compileLiteral(d,b),this._emitLine(";")):(this._emit(`${this.buffer} += runtime.suppressValue(`),this.throwOnUndefined&&this._emit("runtime.ensureDefined("),this.compile(d,b),this.throwOnUndefined&&this._emit(`,${a.lineno},${a.colno})`),this._emit(`, env.opts.autoescape);
`))})}compileRoot(a,b){b&&this.fail("compileRoot: root node can't have frame"),b=new p(),this._emitFuncBegin(a,"root"),this._emitLine("var parentTemplate = null;"),this._compileChildren(a,b),this._emitLine("if(parentTemplate) {"),this._emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this._emitLine("} else {"),this._emitLine(`cb(null, ${this.buffer});`),this._emitLine("}"),this._emitFuncEnd(!0),this.inBlock=!0;const c=[],d=a.findAll(g.Block);d.forEach((e,f)=>{const h=e.name.value;if(c.indexOf(h)!==-1)throw new Error(`Block "${h}" defined more than once.`);c.push(h),this._emitFuncBegin(e,`b_${h}`);const k=new p();this._emitLine("var frame = frame.push(true);"),this.compile(e.body,k),this._emitFuncEnd()}),this._emitLine("return {"),d.forEach((e,f)=>{const h=`b_${e.name.value}`;this._emitLine(`${h}: ${h},`)}),this._emitLine(`root: root
};`)}compile(a,b){var c=this["compile"+a.typename];c?c.call(this,a,b):this.fail(`compile: Cannot compile node: ${a.typename}`,a.lineno,a.colno)}getCode(){return this.codebuf.join("")}}r.exports={compile:function a(b,c,d,e,f={}){const h=new q(e,f.throwOnUndefined),k=(d||[]).map(l=>l.preprocess).filter(l=>!!l),i=k.reduce((l,m)=>m(l),b);return h.compile(t.transform(s.parse(i,d,f),c,e)),h.getCode()},Compiler:q}},7(e,u){"use strict";var i=k$(11),l=k$(21),e=u.exports={};function m(a,b){return a===null||a===void 0||a===!1?b:a}e.abs=Math.abs;function n(a){return a!==a}function v(a,b,c){var d,g=[],f=[];for(d=0;d<a.length;d++)d%b===0&&f.length&&(g.push(f),f=[]),f.push(a[d]);if(f.length){if(c)for(d=f.length;d<b;d++)f.push(c);g.push(f)}return g}e.batch=v;function p(a){a=m(a,"");const b=a.toLowerCase();return l.copySafeness(a,b.charAt(0).toUpperCase()+b.slice(1))}e.capitalize=p;function w(a,b){a=m(a,""),b=b||80;if(a.length>=b)return a;const c=b-a.length,d=i.repeat(" ",c/2-c%2),g=i.repeat(" ",c/2);return l.copySafeness(a,d+a+g)}e.center=w;function x(a,b,c){return c?a||b:a!==void 0?a:b}e.default=x;function y(a,b,c){if(!i.isObject(a))throw new i.TemplateError("dictsort filter: val must be an object");let d=[];for(let f in a)d.push([f,a[f]]);let g;if(c===void 0||c==="key")g=0;else if(c==="value")g=1;else throw new i.TemplateError("dictsort filter: You can only sort by either key or value");return d.sort((f,j)=>{var h=f[g],k=j[g];return b||(i.isString(h)&&(h=h.toUpperCase()),i.isString(k)&&(k=k.toUpperCase())),h>k?1:h===k?0:-1}),d}e.dictsort=y;function z(a,b){return JSON.stringify(a,null,b)}e.dump=z;function A(a){return a instanceof l.SafeString?a:(a=a===null||a===void 0?"":a,l.markSafe(i.escape(a.toString())))}e.escape=A;function B(a){return a instanceof l.SafeString?a:(a=a===null||a===void 0?"":a,l.markSafe(a.toString()))}e.safe=B;function C(a){return a[0]}e.first=C;function D(a){return a=a===null||a===void 0?"":a,l.markSafe(i.escape(a.toString()))}e.forceescape=D;function E(a,b){return i.groupBy(a,b,this.env.opts.throwOnUndefined)}e.groupby=E;function F(a,b,c){a=m(a,"");if(a==="")return"";b=b||4;const d=a.split(`
`),g=i.repeat(" ",b),f=d.map((j,h)=>h===0&&!c?`${j}
`:`${g}${j}
`).join("");return l.copySafeness(a,f)}e.indent=F;function G(a,b,c){return b=b||"",c&&(a=i.map(a,d=>d[c])),a.join(b)}e.join=G;function H(a){return a[a.length-1]}e.last=H;function I(a){var b=m(a,"");return b!==void 0?typeof Map==="function"&&b instanceof Map||typeof Set==="function"&&b instanceof Set?b.size:i.isObject(b)&&!(b instanceof l.SafeString)?i.keys(b).length:b.length:0}e.length=I;function q(a){if(i.isString(a))return a.split("");{if(i.isObject(a))return i._entries(a||{}).map(([b,c])=>({key:b,value:c}));{if(i.isArray(a))return a;throw new i.TemplateError("list filter: type not iterable")}}}e.list=q;function J(a){return a=m(a,""),a.toLowerCase()}e.lower=J;function K(a){return a===null||a===void 0?"":l.copySafeness(a,a.replace(/\r\n|\n/g,`<br />
`))}e.nl2br=K;function L(a){return a[Math.floor(Math.random()*a.length)]}e.random=L;function r(a){function b(c,d="truthy",g){const f=this,j=f.env.getTest(d);return i.toArray(c).filter(function h(k){return j.call(f,k,g)===a})}return b}e.reject=r(!1);function M(a,b){return a.filter(c=>!c[b])}e.rejectattr=M,e.select=r(!0);function N(a,b){return a.filter(c=>!!c[b])}e.selectattr=N;function O(a,b,c,d){var g=a;if(b instanceof RegExp)return a.replace(b,c);typeof d==="undefined"&&(d=-1);let f="";if(typeof b==="number")b=""+b;else if(typeof b!=="string")return a;typeof a==="number"&&(a=""+a);if(typeof a!=="string"&&!(a instanceof l.SafeString))return a;if(b==="")return f=c+a.split("").join(c)+c,l.copySafeness(a,f);let j=a.indexOf(b);if(d===0||j===-1)return a;let h=0,k=0;for(;j>-1&&(d===-1||k<d);)f+=a.substring(h,j)+c,h=j+b.length,k++,j=a.indexOf(b,h);return h<a.length&&(f+=a.substring(h)),l.copySafeness(g,f)}e.replace=O;function P(a){var b;return i.isString(a)?b=q(a):b=i.map(a,c=>c),b.reverse(),i.isString(a)?l.copySafeness(a,b.join("")):b}e.reverse=P;function Q(a,b,c){b=b||0;const d=Math.pow(10,b);let g;return c==="ceil"?g=Math.ceil:c==="floor"?g=Math.floor:g=Math.round,g(a*d)/d}e.round=Q;function R(a,b,c){const d=Math.floor(a.length/b),g=a.length%b,f=[];let j=0;for(let h=0;h<b;h++){const k=j+h*d;h<g&&j++;const ga=j+(h+1)*d,t=a.slice(k,ga);c&&h>=g&&t.push(c),f.push(t)}return f}e.slice=R;function S(a,b,c=0){return b&&(a=i.map(a,d=>d[b])),c+a.reduce((d,g)=>d+g,0)}e.sum=S,e.sort=l.makeMacro(["value","reverse","case_sensitive","attribute"],[],(a,b,c,d)=>{let g=i.map(a,f=>f);return g.sort((f,j)=>{let h=d?f[d]:f,k=d?j[d]:j;return!c&&i.isString(h)&&i.isString(k)&&(h=h.toLowerCase(),k=k.toLowerCase()),h<k?b?1:-1:h>k?b?-1:1:0}),g});function T(a){return l.copySafeness(a,a)}e.string=T;function U(a,b){a=m(a,"");let c=/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,d=s(a.replace(c,"")),g="";return b?g=d.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,`
`).replace(/\n\n\n+/g,`

`):g=d.replace(/\s+/gi," "),l.copySafeness(a,g)}e.striptags=U;function V(a){a=m(a,"");let b=a.split(" ").map(c=>p(c));return l.copySafeness(a,b.join(" "))}e.title=V;function s(a){return l.copySafeness(a,a.replace(/^\s*|\s*$/g,""))}e.trim=s;function W(a,b,c,d){var g=a;a=m(a,""),b=b||255;if(a.length<=b)return a;if(c)a=a.substring(0,b);else{let f=a.lastIndexOf(" ",b);f===-1&&(f=b),a=a.substring(0,f)}return a+=d!==void 0&&d!==null?d:"...",l.copySafeness(g,a)}e.truncate=W;function X(a){return a=m(a,""),a.toUpperCase()}e.upper=X;function Y(a){var b=encodeURIComponent;if(i.isString(a))return b(a);{let c=i.isArray(a)?a:i._entries(a);return c.map(([d,g])=>`${b(d)}=${b(g)}`).join("&")}}e.urlencode=Y;const Z=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,_=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,$=/^https?:\/\/.*$/,aa=/^www\./,ba=/\.(?:org|net|com)(?:\:|\/|$)/;function ca(a,b,c){n(b)&&(b=Infinity);const d=c===!0?' rel="nofollow"':"",g=a.split(/(\s+)/).filter(f=>f&&f.length).map(f=>{var j=f.match(Z),h=j?j[1]:f,k=h.substr(0,b);return $.test(h)?`<a href="${h}"${d}>${k}</a>`:aa.test(h)?`<a href="http://${h}"${d}>${k}</a>`:_.test(h)?`<a href="mailto:${h}">${h}</a>`:ba.test(h)?`<a href="http://${h}"${d}>${k}</a>`:f});return g.join("")}e.urlize=ca;function da(a){a=m(a,"");const b=a?a.match(/\w+/g):null;return b?b.length:null}e.wordcount=da;function ea(a,b){var c=parseFloat(a);return n(c)?b:c}e.float=ea;function fa(a,b){var c=parseInt(a,10);return n(c)?b:c}e.int=fa,e.d=e.default,e.e=e.escape},12(g,d){"use strict";const c=require("path"),{EmitterObj:e}=k$(16);d.exports=class h extends e{resolve(a,f){return c.resolve(c.dirname(a),f)}isRelative(a){return a.indexOf("./")===0||a.indexOf("../")===0}}},20(f,c){"use strict";const d=k$(12);class e extends d{constructor(a){super();this.precompiled=a||{}}getSource(a){return this.precompiled[a]?{src:{type:"code",obj:this.precompiled[a]},path:a}:null}}c.exports={PrecompiledLoader:e}},14(p,k){"use strict";const f=require("fs"),g=require("path"),j=k$(12),{PrecompiledLoader:l}=k$(20);class m extends j{constructor(a,b){super();typeof b==="boolean"&&console.log("[nunjucks] Warning: you passed a boolean as the second argument to FileSystemLoader, but it now takes an options object. See http://mozilla.github.io/nunjucks/api.html#filesystemloader"),b=b||{},this.pathsToNames={},this.noCache=!!b.noCache,a?(a=Array.isArray(a)?a:[a],this.searchPaths=a.map(g.normalize)):this.searchPaths=["."]}getSource(a){var b=null,c=this.searchPaths;for(let e=0;e<c.length;e++){const o=g.resolve(c[e]),i=g.resolve(c[e],a);if(i.indexOf(o)===0&&f.existsSync(i)){b=i;break}}if(!b)return null;this.pathsToNames[b]=a;const h={src:f.readFileSync(b,"utf-8"),path:b,noCache:this.noCache};return this.emit("load",a,h),h}}class n extends j{constructor(a){super();a=a||{},this.pathsToNames={},this.noCache=!!a.noCache}getSource(a){if(/^\.?\.?(\/|\\)/.test(a))return null;if(/^[A-Z]:/.test(a))return null;let b;try{b=null.resolve(a)}catch(h){return null}this.pathsToNames[b]=a;const c={src:f.readFileSync(b,"utf-8"),path:b,noCache:this.noCache};return this.emit("load",a,c),c}}k.exports={FileSystemLoader:m,PrecompiledLoader:l,NodeResolveLoader:n}},13(c,b){b.exports=k$(14)},22(b){"use strict";var e=k$(21).SafeString;function f(a){return typeof a==="function"}b.callable=f;function g(a){return a!==void 0}b.defined=g;function h(a,c){return a%c===0}b.divisibleby=h;function i(a){return a instanceof e}b.escaped=i;function j(a,c){return a===c}b.equalto=j,b.eq=b.equalto,b.sameas=b.equalto;function k(a){return a%2===0}b.even=k;function l(a){return!a}b.falsy=l;function m(a,c){return a>=c}b.ge=m;function n(a,c){return a>c}b.greaterthan=n,b.gt=b.greaterthan;function o(a,c){return a<=c}b.le=o;function p(a,c){return a<c}b.lessthan=p,b.lt=b.lessthan;function q(a){return a.toLowerCase()===a}b.lower=q;function r(a,c){return a!==c}b.ne=r;function s(a){return a===null}b.null=s;function t(a){return typeof a==="number"}b.number=t;function u(a){return a%2===1}b.odd=u;function v(a){return typeof a==="string"}b.string=v;function w(a){return!!a}b.truthy=w;function x(a){return a===void 0}b.undefined=x;function y(a){return a.toUpperCase()===a}b.upper=y;function z(a){return typeof Symbol!=="undefined"?!!a[Symbol.iterator]:Array.isArray(a)||typeof a==="string"}b.iterable=z;function A(a){var c=a!==null&&a!==void 0&&typeof a==="object"&&!Array.isArray(a);return Set?c&&!(a instanceof Set):c}b.mapping=A},8(j,f){"use strict";function g(a){var b=-1;return{current:null,reset(){b=-1,this.current=null},next(){return b++,b>=a.length&&(b=0),this.current=a[b],this.current}}}function h(a){a=a||",";let b=!0;return()=>{const c=b?"":a;return b=!1,c}}function i(){return{range(a,b,c){typeof b==="undefined"?(b=a,a=0,c=1):c||(c=1);const e=[];if(c>0)for(let d=a;d<b;d+=c)e.push(d);else for(let d=a;d>b;d+=c)e.push(d);return e},cycler(){return g(Array.prototype.slice.call(arguments))},joiner(a){return h(a)}}}f.exports=i},6(j,g){const h=require("path");g.exports=function k(b,d){function e(a,c){this.name=a,this.path=a,this.defaultEngine=c.defaultEngine,this.ext=h.extname(a);if(!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=(this.defaultEngine[0]!=="."?".":"")+this.defaultEngine)}return e.prototype.render=function a(c,i){b.render(this.name,c,i)},d.set("view",e),d.set("nunjucksEnv",b),b}},5(N,B){"use strict";const C=k$(1),D=k$(0),g=k$(11),E=k$(4),F=k$(7),{FileSystemLoader:t,WebLoader:u,PrecompiledLoader:G}=k$(13),H=k$(22),I=k$(8),{Obj:v,EmitterObj:J}=k$(16),p=k$(21),{handleError:K,Frame:w}=p,L=k$(6);function q(a,b,c){C(()=>{a(b,c)})}const M={type:"code",obj:{root(a,b,c,d,e){try{e(null,"")}catch(h){e(K(h,null,null))}}}};class r extends J{init(a,b){b=this.opts=b||{},this.opts.dev=!!b.dev,this.opts.autoescape=b.autoescape!=null?b.autoescape:!0,this.opts.throwOnUndefined=!!b.throwOnUndefined,this.opts.trimBlocks=!!b.trimBlocks,this.opts.lstripBlocks=!!b.lstripBlocks,this.loaders=[],a?this.loaders=g.isArray(a)?a:[a]:t?this.loaders=[new t("views")]:u&&(this.loaders=[new u("/views")]),typeof window!=="undefined"&&window.nunjucksPrecompiled&&this.loaders.unshift(new G(window.nunjucksPrecompiled)),this._initLoaders(),this.globals=I(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],g._entries(F).forEach(([c,d])=>this.addFilter(c,d)),g._entries(H).forEach(([c,d])=>this.addTest(c,d))}_initLoaders(){this.loaders.forEach(a=>{a.cache={},typeof a.on==="function"&&(a.on("update",(b,c)=>{a.cache[b]=null,this.emit("update",b,c,a)}),a.on("load",(b,c)=>{this.emit("load",b,c,a)}))})}invalidateCache(){this.loaders.forEach(a=>{a.cache={}})}addExtension(a,b){return b.__name=a,this.extensions[a]=b,this.extensionsList.push(b),this}removeExtension(a){var b=this.getExtension(a);if(!b)return;this.extensionsList=g.without(this.extensionsList,b),delete this.extensions[a]}getExtension(a){return this.extensions[a]}hasExtension(a){return!!this.extensions[a]}addGlobal(a,b){return this.globals[a]=b,this}getGlobal(a){if(typeof this.globals[a]==="undefined")throw new Error("global not found: "+a);return this.globals[a]}addFilter(a,b,c){var d=b;return c&&this.asyncFilters.push(a),this.filters[a]=d,this}getFilter(a){if(!this.filters[a])throw new Error("filter not found: "+a);return this.filters[a]}addTest(a,b){return this.tests[a]=b,this}getTest(a){if(!this.tests[a])throw new Error("test not found: "+a);return this.tests[a]}resolveTemplate(a,b,c){var d=a.isRelative&&b?a.isRelative(c):!1;return d&&a.resolve?a.resolve(b,c):c}getTemplate(a,b,c,d,e){var h=this,j=null;a&&a.raw&&(a=a.raw),g.isFunction(c)&&(e=c,c=null,b=b||!1),g.isFunction(b)&&(e=b,b=!1);if(a instanceof o)j=a;else{if(typeof a!=="string")throw new Error("template names must be a string: "+a);for(let f=0;f<this.loaders.length;f++){const l=this.loaders[f];j=l.cache[this.resolveTemplate(l,c,a)];if(j)break}}if(j){b&&j.compile();if(e){e(null,j);return}else return j}let m;const i=(f,l)=>{!l&&!f&&!d&&(f=new Error("template not found: "+a));if(f)if(e){e(f);return}else throw f;let n;l?(n=new o(l.src,this,l.path,b),l.noCache||(l.loader.cache[a]=n)):n=new o(M,this,"",b),e?e(null,n):m=n};return g.asyncIter(this.loaders,(f,l,n,y)=>{function z(A,s){A?y(A):s?(s.loader=f,y(null,s)):n()}a=h.resolveTemplate(f,c,a),f.async?f.getSource(a,z):z(null,f.getSource(a))},i),m}express(a){return L(this,a)}render(a,b,c){g.isFunction(b)&&(c=b,b=null);let d=null;return this.getTemplate(a,(e,h)=>{if(e&&c)q(c,e);else{if(e)throw e;d=h.render(b,c)}}),d}renderString(a,b,c,d){g.isFunction(c)&&(d=c,c={}),c=c||{};const e=new o(a,this,c.path);return e.render(b,d)}waterfall(a,b,c){return D(a,b,c)}}class x extends v{init(a,b,c){this.env=c||new r(),this.ctx=g.extend({},a),this.blocks={},this.exported=[],g.keys(b).forEach(d=>{this.addBlock(d,b[d])})}lookup(a){return a in this.env.globals&&!(a in this.ctx)?this.env.globals[a]:this.ctx[a]}setVariable(a,b){this.ctx[a]=b}getVariables(){return this.ctx}addBlock(a,b){return this.blocks[a]=this.blocks[a]||[],this.blocks[a].push(b),this}getBlock(a){if(!this.blocks[a])throw new Error('unknown block "'+a+'"');return this.blocks[a][0]}getSuper(a,b,c,d,e,h){var j=g.indexOf(this.blocks[b]||[],c),m=this.blocks[b][j+1],i=this;if(j===-1||!m)throw new Error('no super block available for "'+b+'"');m(a,i,d,e,h)}addExport(a){this.exported.push(a)}getExported(){var a={};return this.exported.forEach(b=>{a[b]=this.ctx[b]}),a}}class o extends v{init(a,b,c,d){this.env=b||new r();if(g.isObject(a))switch(a.type){case"code":this.tmplProps=a.obj;break;case"string":this.tmplStr=a.obj;break;default:throw new Error(`Unexpected template object type ${a.type}; expected 'code', or 'string'`)}else if(g.isString(a))this.tmplStr=a;else throw new Error("src must be a string or an object describing the source");this.path=c;if(d)try{this._compile()}catch(e){throw g._prettifyError(this.path,this.env.opts.dev,e)}else this.compiled=!1}render(a,b,c){typeof a==="function"?(c=a,a={}):typeof b==="function"&&(c=b,b=null);const d=!b;try{this.compile()}catch(i){const f=g._prettifyError(this.path,this.env.opts.dev,i);if(c)return q(c,f);throw f}const e=new x(a||{},this.blocks,this.env),h=b?b.push(!0):new w();h.topLevel=!0;let j=null,m=!1;return this.rootRenderFunc(this.env,e,h,p,(i,f)=>{if(m){if(c)return;throw i}i&&(i=g._prettifyError(this.path,this.env.opts.dev,i),m=!0);if(c)d?q(c,i,f):c(i,f);else{if(i)throw i;j=f}}),j}getExported(a,b,c){typeof a==="function"&&(c=a,a={}),typeof b==="function"&&(c=b,b=null);try{this.compile()}catch(h){if(c)return c(h);throw h}const d=b?b.push():new w();d.topLevel=!0;const e=new x(a||{},this.blocks,this.env);this.rootRenderFunc(this.env,e,d,p,h=>{h?c(h,null):c(null,e.getExported())})}compile(){this.compiled||this._compile()}_compile(){var a;if(this.tmplProps)a=this.tmplProps;else{const b=E.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts),c=new Function(b);a=c()}this.blocks=this._getBlocks(a),this.rootRenderFunc=a.root,this.compiled=!0}_getBlocks(a){var b={};return g.keys(a).forEach(c=>{c.slice(0,2)==="b_"&&(b[c.slice(2)]=a[c])}),b}}B.exports={Environment:r,Template:o}},18(i,f){"use strict";function g(c,d){var a="";d=d||{};for(let b=0;b<c.length;b++){const e=JSON.stringify(c[b].name),h=c[b].template;a+="(function() {(window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["+e+`] = (function() {
`+h+`
})();
`,d.asFunction&&(a+="return function(ctx, cb) { return nunjucks.render("+e+`, ctx, cb); }
`),a+=`})();
`}return a}f.exports=g},19(z,v){"use strict";const g=require("fs"),l=require("path"),{_prettifyError:w}=k$(11),x=k$(4),{Environment:m}=k$(5),q=k$(18);function r(b,a){return Array.isArray(a)?a.some(c=>b.match(c)):!1}function s(b,a){a=a||{},a.isString=!0;const c=a.env||new m([]),j=a.wrapper||q;if(!a.name)throw new Error('the "name" option is required when compiling a string');return j([n(b,a.name,c)],a)}function y(b,a){a=a||{};const c=a.env||new m([]),j=a.wrapper||q;if(a.isString)return s(b,a);const k=g.existsSync(b)&&g.statSync(b),h=[],i=[];function t(d){g.readdirSync(d).forEach(o=>{const e=l.join(d,o);let p=e.substr(l.join(b,"/").length);const u=g.statSync(e);u&&u.isDirectory()?(p+="/",r(p,a.exclude)||t(e)):r(p,a.include)&&i.push(e)})}if(k.isFile())h.push(n(g.readFileSync(b,"utf-8"),a.name||b,c));else if(k.isDirectory()){t(b);for(let d=0;d<i.length;d++){const o=i[d].replace(l.join(b,"/"),"");try{h.push(n(g.readFileSync(i[d],"utf-8"),o,c))}catch(e){if(a.force)console.error(e);else throw e}}}return j(h,a)}function n(b,a,c){c=c||new m([]);const j=c.asyncFilters,k=c.extensionsList;let h;a=a.replace(/\\/g,"/");try{h=x.compile(b,j,k,a,c.opts)}catch(i){throw w(a,!1,i)}return{name:a,template:h}}v.exports={precompile:y,precompileString:s}},9(D,y){function z(){"use strict";var i=this.runtime,g=this.lib,j=this.compiler.Compiler,l=this.parser.Parser,m=this.nodes,p=this.lexer,u=i.contextOrFrameLookup,v=i.memberLookup,r,s;j&&(r=j.prototype.assertType),l&&(s=l.prototype.parseAggregate);function A(){i.contextOrFrameLookup=u,i.memberLookup=v,j&&(j.prototype.assertType=r),l&&(l.prototype.parseAggregate=s)}i.contextOrFrameLookup=function a(b,c,d){var f=u.apply(this,arguments);if(f!==void 0)return f;switch(d){case"True":return!0;case"False":return!1;case"None":return null;default:return}};function w(a){return{index:a.index,lineno:a.lineno,colno:a.colno}}if(process.env.BUILD_TYPE!=="SLIM"&&m&&j&&l){const a=m.Node.extend("Slice",{fields:["start","stop","step"],init(b,c,d,f,e){d=d||new m.Literal(b,c,null),f=f||new m.Literal(b,c,null),e=e||new m.Literal(b,c,1),this.parent(b,c,d,f,e)}});j.prototype.assertType=function b(c){if(c instanceof a)return;r.apply(this,arguments)},j.prototype.compileSlice=function b(c,d){this._emit("("),this._compileExpression(c.start,d),this._emit("),("),this._compileExpression(c.stop,d),this._emit("),("),this._compileExpression(c.step,d),this._emit(")")},l.prototype.parseAggregate=function b(){var c=w(this.tokens);c.colno--,c.index--;try{return s.apply(this)}catch(d){const f=w(this.tokens),e=()=>(g._assign(this.tokens,f),d);g._assign(this.tokens,c),this.peeked=!1;const k=this.peekToken();if(k.type!==p.TOKEN_LEFT_BRACKET)throw e();this.nextToken();const n=new a(k.lineno,k.colno);let o=!1;for(let q=0;q<=n.fields.length;q++){if(this.skip(p.TOKEN_RIGHT_BRACKET))break;if(q===n.fields.length)if(o)this.fail("parseSlice: too many slice components",k.lineno,k.colno);else break;if(this.skip(p.TOKEN_COLON))o=!0;else{const C=n.fields[q];n[C]=this.parseExpression(),o=this.skip(p.TOKEN_COLON)||o}}if(!o)throw e();return new m.Array(k.lineno,k.colno,[n])}}}function B(a,b,c,d){a=a||[],b===null&&(b=d<0?a.length-1:0),c===null?c=d<0?-1:a.length:c<0&&(c+=a.length),b<0&&(b+=a.length);const f=[];for(let e=b;;e+=d){if(e<0||e>a.length)break;if(d>0&&e>=c)break;if(d<0&&e<=c)break;f.push(i.memberLookup(a,e))}return f}function t(a,b){return Object.prototype.hasOwnProperty.call(a,b)}const x={pop(a){if(a===void 0)return this.pop();if(a>=this.length||a<0)throw new Error("KeyError");return this.splice(a,1)},append(a){return this.push(a)},remove(a){for(let b=0;b<this.length;b++)if(this[b]===a)return this.splice(b,1);throw new Error("ValueError")},count(a){var b=0;for(let c=0;c<this.length;c++)this[c]===a&&b++;return b},index(a){var b;if((b=this.indexOf(a))===-1)throw new Error("ValueError");return b},find(a){return this.indexOf(a)},insert(a,b){return this.splice(a,0,b)}},h={items(){return g._entries(this)},values(){return g._values(this)},keys(){return g.keys(this)},get(a,b){var c=this[a];return c===void 0&&(c=b),c},has_key(a){return t(this,a)},pop(a,b){var c=this[a];if(c===void 0&&b!==void 0)c=b;else{if(c===void 0)throw new Error("KeyError");delete this[a]}return c},popitem(){const a=g.keys(this);if(!a.length)throw new Error("KeyError");const b=a[0],c=this[b];return delete this[b],[b,c]},setdefault(a,b=null){return a in this||(this[a]=b),this[a]},update(a){return g._assign(this,a),null}};return h.iteritems=h.items,h.itervalues=h.values,h.iterkeys=h.keys,i.memberLookup=function a(b,c,d){return arguments.length===4?B.apply(this,arguments):(b=b||{},g.isArray(b)&&t(x,c)?x[c].bind(b):g.isObject(b)&&t(h,c)?h[c].bind(b):v.apply(this,arguments))},A}y.exports=z},3(u,l){"use strict";const i=k$(11),{Environment:j,Template:k}=k$(5),m=k$(12),f=k$(13),g=k$(19),n=k$(4),o=k$(17),p=k$(10),q=k$(21),r=k$(15),s=k$(9);let d;function h(c,a){a=a||{},i.isObject(c)&&(a=c,c=null);let e;return f.FileSystemLoader?e=new f.FileSystemLoader(c,{watch:a.watch,noCache:a.noCache}):f.WebLoader&&(e=new f.WebLoader(c,{useCache:a.web&&a.web.useCache,async:a.web&&a.web.async})),d=new j(e,a),a&&a.express&&d.express(a.express),d}l.exports={Environment:j,Template:k,Loader:m,FileSystemLoader:f.FileSystemLoader,NodeResolveLoader:f.NodeResolveLoader,PrecompiledLoader:f.PrecompiledLoader,WebLoader:f.WebLoader,compiler:n,parser:o,lexer:p,runtime:q,lib:i,nodes:r,installJinjaCompat:s,configure:h,reset(){d=void 0},compile(c,a,e,t){return d||h(),new k(c,a,e,t)},render(c,a,e){return d||h(),d.render(c,a,e)},renderString(c,a,e){return d||h(),d.renderString(c,a,e)},precompile:g?g.precompile:void 0,precompileString:g?g.precompileString:void 0}}};module.exports=k$(3);
